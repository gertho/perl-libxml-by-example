

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>The Document Object Model &mdash; Perl XML::LibXML by Example  documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="_static/plxbe.css" type="text/css" />
  

  
    <link rel="top" title="Perl XML::LibXML by Example  documentation" href="index.html"/>
        <link rel="next" title="Installing XML::LibXML" href="installation.html"/>
        <link rel="prev" title="XPath Expressions" href="xpath.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Perl XML::LibXML by Example
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="basics.html">A Basic Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="xpath.html">XPath Expressions</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">The Document Object Model</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#the-document-object">The &#8216;Document&#8217; object</a></li>
<li class="toctree-l2"><a class="reference internal" href="#element-objects">&#8216;Element&#8217; objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="#text-objects">&#8216;Text&#8217; objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="#attr-objects">&#8216;Attr&#8217; objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="#nodelist-objects">&#8216;NodeList&#8217; objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="#modifying-the-dom">Modifying the DOM</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installing XML::LibXML</a></li>
</ul>

            
          
        </div>
        <div class="custom-sidebar">
  <h3>Project Source</h3>
  <ul>
    <li><a href="https://github.com/grantm/perl-libxml-by-example">Project
    repository on GitHub</a></li>
    <li class="cc-img"><a rel="license" title="Creative Commons Attribution-ShareAlike License" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons CC-BY-SA License" style="border-width:0" src="_static/cc-by-sa.png" /></a></li>
  </ul>
</div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Perl XML::LibXML by Example</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>The Document Object Model</li>
    <li class="wy-breadcrumbs-aside">
      
        
          <a href="_sources/dom.txt" rel="nofollow"> View page source</a>
        
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="the-document-object-model">
<h1>The Document Object Model<a class="headerlink" href="#the-document-object-model" title="Permalink to this headline">¶</a></h1>
<p>The <a class="reference internal" href="basics.html"><em>basic examples</em></a> section introduced the <tt class="docutils literal"><span class="pre">findnodes()</span></tt> method
and XPath expressions for extracting parts of an XML document.  For most
applications, that&#8217;s pretty much all you need, but sometimes it&#8217;s necessary to
use lower-level methods and to understand the relationships between different
parts of the document.</p>
<p>The XML::LibXML module implements Perl bindings for the <a class="reference external" href="https://www.w3.org/TR/DOM-Level-3-Core/core.html">W3C Document Object
Model</a>.  The W3C DOM
defines object classes, properties and methods for querying and manipulating
the different parts of an XML (or HTML) document.  In the Perl implementation,
object properties are exposed via accessor methods.</p>
<p>Let&#8217;s start our exploration of the DOM with a simple XML document which
describes <a class="reference external" href="http://www.bookdepository.com/isbn/9780764142239">a book</a> -
<a class="reference download internal" href="_downloads/book.xml"><tt class="xref download docutils literal"><span class="pre">book.xml</span></tt></a></p>
<div class="highlight-xml"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span class="cp">&lt;?xml version=&#39;1.0&#39; encoding=&#39;UTF-8&#39; standalone=&quot;yes&quot; ?&gt;</span>
<span class="nt">&lt;book&gt;</span>
  <span class="nt">&lt;title</span> <span class="na">edition=</span><span class="s">&quot;2&quot;</span><span class="nt">&gt;</span>Training Your Pet Ferret<span class="nt">&lt;/title&gt;</span>
  <span class="nt">&lt;authors&gt;</span>
    <span class="nt">&lt;author&gt;</span>Gerry Bucsis<span class="nt">&lt;/author&gt;</span>
    <span class="nt">&lt;author&gt;</span>Barbara Somerville<span class="nt">&lt;/author&gt;</span>
  <span class="nt">&lt;/authors&gt;</span>
  <span class="nt">&lt;isbn&gt;</span>9780764142239<span class="nt">&lt;/isbn&gt;</span>
  <span class="nt">&lt;dimensions</span> <span class="na">width=</span><span class="s">&quot;162.56mm&quot;</span> <span class="na">height=</span><span class="s">&quot;195.58mm&quot;</span> <span class="na">depth=</span><span class="s">&quot;10.16mm&quot;</span> <span class="na">pages=</span><span class="s">&quot;96&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/book&gt;</span>
</pre></div>
</td></tr></table></div>
<p>When you ask XML::LibXML to parse the document, it creates an object to
represent each part of the document and assembles those objects into a
hierarchy as shown here:</p>
<div class="figure">
<img alt="An XML document represented as a Document Object Model" class="illustration" src="_images/dom.png" />
<p class="caption">A simplified representation of the Document Object Model.</p>
</div>
<p>The source XML document has a <tt class="docutils literal"><span class="pre">&lt;book&gt;</span></tt> element which contains four other
elements: <tt class="docutils literal"><span class="pre">&lt;title&gt;</span></tt>, <tt class="docutils literal"><span class="pre">&lt;authors&gt;</span></tt>, <tt class="docutils literal"><span class="pre">&lt;isbn&gt;</span></tt> and <tt class="docutils literal"><span class="pre">&lt;dimensions&gt;</span></tt>.  The
<tt class="docutils literal"><span class="pre">&lt;authors&gt;</span></tt> element in turn contains two <tt class="docutils literal"><span class="pre">&lt;author&gt;</span></tt> elements.</p>
<p>The hierarchy in the picture shows us that <tt class="docutils literal"><span class="pre">&lt;book&gt;</span></tt> has four &#8220;child&#8221;
elements.  Similarly, <tt class="docutils literal"><span class="pre">&lt;authors&gt;</span></tt> has two child elements and one &#8220;parent&#8221;
element (<tt class="docutils literal"><span class="pre">&lt;book&gt;</span></tt>).  Five of the elements have no child elements but four of
them do contain text content and one has some attributes.</p>
<div class="section" id="the-document-object">
<h2>The &#8216;Document&#8217; object<a class="headerlink" href="#the-document-object" title="Permalink to this headline">¶</a></h2>
<p>When you parse a document with XML::LibXML the parser returns a &#8216;Document&#8217;
object - represented in yellow in the picture above.  The reference
documentation for the <a class="reference external" href="https://metacpan.org/pod/XML::LibXML::Document">XML::LibXML::Document</a> class lists methods you can
use to interact with the document.  The &#8216;Document&#8217; class inherits from the
&#8216;Node&#8217; class so you&#8217;ll also need to refer to the docs for <a class="reference external" href="https://metacpan.org/pod/XML::LibXML::Node">XML::LibXML::Node</a> as well.</p>
<div class="highlight-perl"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">my</span> <span class="nv">$dom</span> <span class="o">=</span> <span class="nn">XML::</span><span class="n">LibXML</span><span class="o">-&gt;</span><span class="n">load_xml</span><span class="p">(</span><span class="n">location</span> <span class="o">=&gt;</span> <span class="s">&#39;book.xml&#39;</span><span class="p">);</span>

<span class="n">say</span> <span class="s">&#39;$dom is a &#39;</span><span class="p">,</span> <span class="nb">ref</span><span class="p">(</span><span class="nv">$dom</span><span class="p">);</span>
<span class="n">say</span> <span class="s">&#39;$dom-&gt;nodeName is: &#39;</span><span class="p">,</span> <span class="nv">$dom</span><span class="o">-&gt;</span><span class="n">nodeName</span><span class="p">;</span>
</pre></div>
</td></tr></table></div>
<p>Output:</p>
<div class="highlight-none"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre>$dom is a XML::LibXML::Document
$dom-&gt;nodeName is: #document
</pre></div>
</td></tr></table></div>
<p>The document object also provides methods you can use to extract information
from the XML declaration section - the very first line of the source XML,
which precedes the <tt class="docutils literal"><span class="pre">&lt;book&gt;</span></tt> element:</p>
<div class="highlight-perl"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span class="n">say</span> <span class="s">&#39;XML Version is: &#39;</span><span class="p">,</span> <span class="nv">$dom</span><span class="o">-&gt;</span><span class="n">version</span><span class="p">;</span>
<span class="n">say</span> <span class="s">&#39;Document encoding is: &#39;</span><span class="p">,</span> <span class="nv">$dom</span><span class="o">-&gt;</span><span class="n">encoding</span><span class="p">;</span>
<span class="k">my</span> <span class="nv">$is_or_not</span> <span class="o">=</span> <span class="nv">$dom</span><span class="o">-&gt;</span><span class="n">standalone</span> <span class="p">?</span> <span class="s">&#39;is&#39;</span> <span class="p">:</span> <span class="s">&#39;is not&#39;</span><span class="p">;</span>
<span class="n">say</span> <span class="s">&quot;Document $is_or_not standalone&quot;</span><span class="p">;</span>
</pre></div>
</td></tr></table></div>
<p>Output:</p>
<div class="highlight-none"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre>XML Version is: 1.0
Document encoding is: UTF-8
Document is standalone
</pre></div>
</td></tr></table></div>
<p>You can serialise a whole DOM back out to XML by calling the <tt class="docutils literal"><span class="pre">toString()</span></tt>
method on the document object:</p>
<div class="highlight-perl"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span class="n">say</span> <span class="s">&quot;DOM as XML:\n&quot;</span><span class="p">,</span> <span class="nv">$dom</span><span class="o">-&gt;</span><span class="n">toString</span><span class="p">;</span>
</pre></div>
</td></tr></table></div>
<p>The document class also overrides the stringification operator, so if you
simply treat the object as a string and print it out you&#8217;ll also get the
serialised XML:</p>
<div class="highlight-perl"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span class="n">say</span> <span class="s">&quot;DOM as a string:\n&quot;</span><span class="p">,</span> <span class="nv">$dom</span><span class="p">;</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="element-objects">
<h2>&#8216;Element&#8217; objects<a class="headerlink" href="#element-objects" title="Permalink to this headline">¶</a></h2>
<p>The blue boxes in the picture represent &#8216;Element&#8217; nodes.  The reference
documentation for the <a class="reference external" href="https://metacpan.org/pod/XML::LibXML::Element">XML::LibXML::Element</a> class lists a number of
methods, but like the &#8216;Document&#8217; class, many more methods are inherited from
<a class="reference external" href="https://metacpan.org/pod/XML::LibXML::Node">XML::LibXML::Node</a>.</p>
<p>Every XML document has one single top-level element known as the &#8220;document
element&#8221; that encloses all the other elements - in our example it&#8217;s the
<tt class="docutils literal"><span class="pre">&lt;book&gt;</span></tt> element.  You can retrieve this element by calling the
<tt class="docutils literal"><span class="pre">documentElement()</span></tt> method on the document object and you can determine
what type of element it is by calling <tt class="docutils literal"><span class="pre">nodeName()</span></tt>:</p>
<div class="highlight-perl"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">my</span> <span class="nv">$book</span> <span class="o">=</span> <span class="nv">$dom</span><span class="o">-&gt;</span><span class="n">documentElement</span><span class="p">;</span>
<span class="n">say</span> <span class="s">&#39;$book is a &#39;</span><span class="p">,</span> <span class="nb">ref</span><span class="p">(</span><span class="nv">$book</span><span class="p">);</span>
<span class="n">say</span> <span class="s">&#39;$book-&gt;nodeName is: &#39;</span><span class="p">,</span> <span class="nv">$book</span><span class="o">-&gt;</span><span class="n">nodeName</span><span class="p">;</span>
</pre></div>
</td></tr></table></div>
<p>Output:</p>
<div class="highlight-none"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre>$book is a XML::LibXML::Element
$book-&gt;nodeName is: book
</pre></div>
</td></tr></table></div>
<p>The <tt class="docutils literal"><span class="pre">&lt;book&gt;</span></tt> element has four child elements.  You can use
<tt class="docutils literal"><span class="pre">getChildrenByTagName()</span></tt> to get a list of all the child elements with a
specific element name (this is not a recursive search, it only looks through
elements which are direct children):</p>
<div class="highlight-perl"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">my</span><span class="p">(</span><span class="nv">$isbn</span><span class="p">)</span> <span class="o">=</span> <span class="nv">$book</span><span class="o">-&gt;</span><span class="n">getChildrenByTagName</span><span class="p">(</span><span class="s">&#39;isbn&#39;</span><span class="p">);</span>
<span class="n">say</span> <span class="s">&#39;$isbn is a &#39;</span><span class="p">,</span> <span class="nb">ref</span><span class="p">(</span><span class="nv">$isbn</span><span class="p">);</span>
<span class="n">say</span> <span class="s">&#39;$isbn-&gt;nodeName is: &#39;</span><span class="p">,</span> <span class="nv">$isbn</span><span class="o">-&gt;</span><span class="n">nodeName</span><span class="p">;</span>
<span class="n">say</span> <span class="s">&#39;$isbn-&gt;to_literal returns: &#39;</span><span class="p">,</span> <span class="nv">$isbn</span><span class="o">-&gt;</span><span class="n">to_literal</span><span class="p">;</span>
<span class="n">say</span> <span class="s">&#39;$isbn stringifies to: &#39;</span><span class="p">,</span> <span class="nv">$isbn</span><span class="p">;</span>
</pre></div>
</td></tr></table></div>
<p>Output:</p>
<div class="highlight-none"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre>$isbn is a XML::LibXML::Element
$isbn-&gt;nodeName is: isbn
$isbn-&gt;to_literal returns: 9780764142239
$isbn stringifies to: &lt;isbn&gt;9780764142239&lt;/isbn&gt;
</pre></div>
</td></tr></table></div>
<p>If you&#8217;re not looking for one specific type of element, you can get all the
children with <tt class="docutils literal"><span class="pre">childNodes()</span></tt>:</p>
<div class="highlight-perl"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">my</span> <span class="nv">@children</span> <span class="o">=</span> <span class="nv">$book</span><span class="o">-&gt;</span><span class="n">childNodes</span><span class="p">;</span>
<span class="k">my</span> <span class="nv">$count</span> <span class="o">=</span> <span class="nv">@children</span><span class="p">;</span>
<span class="n">say</span> <span class="s">&quot;\$book has $count child nodes:&quot;</span><span class="p">;</span>
<span class="k">my</span> <span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="k">foreach</span> <span class="k">my</span> <span class="nv">$child</span> <span class="p">(</span><span class="nv">@children</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">say</span> <span class="nv">$i</span><span class="o">++</span><span class="p">,</span> <span class="s">&quot;: is a &quot;</span><span class="p">,</span> <span class="nb">ref</span><span class="p">(</span><span class="nv">$child</span><span class="p">),</span> <span class="s">&#39;, name = &#39;</span><span class="p">,</span> <span class="nv">$child</span><span class="o">-&gt;</span><span class="n">nodeName</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>We already know that <tt class="docutils literal"><span class="pre">&lt;book&gt;</span></tt> contains four child elements, so you may be
a little surprised to see <tt class="docutils literal"><span class="pre">childNodes()</span></tt> returns a list of nine nodes:</p>
<div class="highlight-none"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre>$book has 9 child nodes:
0: is a XML::LibXML::Text, name = #text
1: is a XML::LibXML::Element, name = title
2: is a XML::LibXML::Text, name = #text
3: is a XML::LibXML::Element, name = authors
4: is a XML::LibXML::Text, name = #text
5: is a XML::LibXML::Element, name = isbn
6: is a XML::LibXML::Text, name = #text
7: is a XML::LibXML::Element, name = dimensions
8: is a XML::LibXML::Text, name = #text
</pre></div>
</td></tr></table></div>
<p>If you refer back to the source XML document, you can see that after the
<tt class="docutils literal"><span class="pre">&lt;book&gt;</span></tt> tag and before the <tt class="docutils literal"><span class="pre">&lt;title&gt;</span></tt> tag there is some whitespace: a
line-feed character followed by two spaces at the start of the next line:</p>
<div class="highlight-xml"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span class="nt">&lt;book&gt;</span>
  <span class="nt">&lt;title</span> <span class="na">edition=</span><span class="s">&quot;2&quot;</span><span class="nt">&gt;</span>Training Your Pet Ferret<span class="nt">&lt;/title&gt;</span>
</pre></div>
</td></tr></table></div>
<p>These strings of whitespace are represented in the DOM by &#8216;Text&#8217; nodes, which
are children of the parent element.  So a more accurate DOM diagram would
look like this:</p>
<div class="figure">
<img alt="Document Object Model including whitespace-only text nodes" class="illustration" src="_images/dom-full.png" />
<p class="caption">Document Object Model including whitespace-only text nodes</p>
</div>
<p>If you want to filter child nodes by type, XML::LibXML provides a number of
constants which you can import when you load the module:</p>
<div class="highlight-perl"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">use</span> <span class="nn">XML::</span><span class="n">LibXML</span> <span class="sx">qw(:libxml)</span><span class="p">;</span>
</pre></div>
</td></tr></table></div>
<p>And then you can compare <tt class="docutils literal"><span class="pre">$node-&gt;nodeType</span></tt> to these constants:</p>
<div class="highlight-perl"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">my</span> <span class="nv">@elements</span> <span class="o">=</span> <span class="nb">grep</span> <span class="p">{</span> <span class="nv">$_</span><span class="o">-&gt;</span><span class="n">nodeType</span> <span class="o">==</span> <span class="n">XML_ELEMENT_NODE</span> <span class="p">}</span> <span class="nv">$book</span><span class="o">-&gt;</span><span class="n">childNodes</span><span class="p">;</span>
<span class="nv">$count</span> <span class="o">=</span> <span class="nv">@elements</span><span class="p">;</span>
<span class="n">say</span> <span class="s">&quot;\$book has $count child elements:&quot;</span><span class="p">;</span>
<span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="k">foreach</span> <span class="k">my</span> <span class="nv">$child</span> <span class="p">(</span><span class="nv">@elements</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">say</span> <span class="nv">$i</span><span class="o">++</span><span class="p">,</span> <span class="s">&quot;: is a &quot;</span><span class="p">,</span> <span class="nb">ref</span><span class="p">(</span><span class="nv">$child</span><span class="p">),</span> <span class="s">&#39;, name = &#39;</span><span class="p">,</span> <span class="nv">$child</span><span class="o">-&gt;</span><span class="n">nodeName</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Output:</p>
<div class="highlight-none"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre>$book has 4 child elements:
0: is a XML::LibXML::Element, name = title
1: is a XML::LibXML::Element, name = authors
2: is a XML::LibXML::Element, name = isbn
3: is a XML::LibXML::Element, name = dimensions
</pre></div>
</td></tr></table></div>
<p>But you&#8217;ll generally find that it&#8217;s much easier to just use <tt class="docutils literal"><span class="pre">findnodes()</span></tt>
and <a class="reference internal" href="xpath.html"><em>XPath Expressions</em></a> to select exactly the elements or other nodes you want.</p>
</div>
<div class="section" id="text-objects">
<h2>&#8216;Text&#8217; objects<a class="headerlink" href="#text-objects" title="Permalink to this headline">¶</a></h2>
<p>The green boxes in the picture represent &#8216;Text&#8217; nodes.  The reference
documentation for the <a class="reference external" href="https://metacpan.org/pod/XML::LibXML::Text">XML::LibXML::Text</a> class lists a small number of
methods and many more are inherited from the Node class.</p>
<p>There are numerous ways to get the text string out of a Text object but it&#8217;s
important to be clear on whether you want the text as it appears in the XML
(including any entity escaping) or whether you want the plain text that the
source represents.  Consider this tiny source document:</p>
<div class="highlight-xml"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span class="nt">&lt;item&gt;</span>Fish <span class="ni">&amp;amp;</span> Chips<span class="nt">&lt;/item&gt;</span>
</pre></div>
</td></tr></table></div>
<p>And these different methods for accessing the text:</p>
<div class="highlight-perl"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">my</span> <span class="nv">$item</span> <span class="o">=</span> <span class="nv">$dom</span><span class="o">-&gt;</span><span class="n">documentElement</span><span class="p">;</span>
<span class="k">my</span><span class="p">(</span><span class="nv">$text</span><span class="p">)</span> <span class="o">=</span> <span class="nv">$item</span><span class="o">-&gt;</span><span class="n">childNodes</span><span class="p">();</span>

<span class="n">say</span> <span class="s">&#39;$text is a &#39;</span><span class="p">,</span> <span class="nb">ref</span><span class="p">(</span><span class="nv">$text</span><span class="p">);</span>
<span class="n">say</span> <span class="s">&#39;$text-&gt;data = &#39;</span><span class="p">,</span> <span class="nv">$text</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">;</span>
<span class="n">say</span> <span class="s">&#39;$text-&gt;nodeValue = &#39;</span><span class="p">,</span> <span class="nv">$text</span><span class="o">-&gt;</span><span class="n">nodeValue</span><span class="p">;</span>
<span class="n">say</span> <span class="s">&#39;$text-&gt;to_literal = &#39;</span><span class="p">,</span> <span class="nv">$text</span><span class="o">-&gt;</span><span class="n">to_literal</span><span class="p">;</span>
<span class="n">say</span> <span class="s">&#39;$text-&gt;toString = &#39;</span><span class="p">,</span> <span class="nv">$text</span><span class="o">-&gt;</span><span class="n">toString</span><span class="p">;</span>
<span class="n">say</span> <span class="s">&#39;$text as a string: &#39;</span><span class="p">,</span> <span class="nv">$text</span><span class="p">;</span>
</pre></div>
</td></tr></table></div>
<p>Producing this output:</p>
<div class="highlight-none"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre>$text is a XML::LibXML::Text
$text-&gt;data = Fish &amp; Chips
$text-&gt;nodeValue = Fish &amp; Chips
$text-&gt;to_literal = Fish &amp; Chips
$text-&gt;toString = Fish &amp;amp; Chips
$text as a string: Fish &amp;amp; Chips
</pre></div>
</td></tr></table></div>
<p>The <tt class="docutils literal"><span class="pre">data()</span></tt> and <tt class="docutils literal"><span class="pre">nodeValue()</span></tt> methods are essentially aliases.  The
<tt class="docutils literal"><span class="pre">to_literal()</span></tt> method produces the same output via a more complex route, but
has the advantage that you can call it on any object in the DOM.</p>
<p>The <tt class="docutils literal"><span class="pre">toString()</span></tt> method is really only useful for serialising a whole DOM or
a DOM fragment out to XML.  Stringification is particularly handy when you just
want to print an object out for debugging purposes.</p>
</div>
<div class="section" id="attr-objects">
<h2>&#8216;Attr&#8217; objects<a class="headerlink" href="#attr-objects" title="Permalink to this headline">¶</a></h2>
<p>The red boxes in the picture represent attributes.  You&#8217;re unlikely to ever
need to deal with attribute <strong>objects</strong> since it&#8217;s easier to get and set
attribute values by calling methods on an Element object and passing in plain
string values.  An even easier approach is to use the tied hash interface that
allows you to treat each element as if it were a hashref and access attribute
values via hash keys:</p>
<div class="highlight-perl"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">my</span> <span class="nv">$book</span> <span class="o">=</span> <span class="nv">$dom</span><span class="o">-&gt;</span><span class="n">documentElement</span><span class="p">;</span>
<span class="k">my</span><span class="p">(</span><span class="nv">$dim</span><span class="p">)</span> <span class="o">=</span> <span class="nv">$book</span><span class="o">-&gt;</span><span class="n">getChildrenByTagName</span><span class="p">(</span><span class="s">&#39;dimensions&#39;</span><span class="p">);</span>

<span class="n">say</span> <span class="s">&#39;$dim-&gt;getAttribute(&quot;width&quot;) = &#39;</span><span class="p">,</span> <span class="nv">$dim</span><span class="o">-&gt;</span><span class="n">getAttribute</span><span class="p">(</span><span class="s">&quot;width&quot;</span><span class="p">);</span>
<span class="n">say</span> <span class="s">&#39;$dim-&gt;{width} = &#39;</span><span class="p">,</span> <span class="nv">$dim</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">width</span><span class="p">};</span>
</pre></div>
</td></tr></table></div>
<p>Output:</p>
<div class="highlight-none"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre>$dim-&gt;getAttribute(&quot;width&quot;) = 162.56mm
$dim-&gt;{width} = 162.56mm
</pre></div>
</td></tr></table></div>
<p>The class name for the attribute objects is &#8216;Attr&#8217; - the unfortunate truncation
of the class name derives from the <a class="reference external" href="https://www.w3.org/TR/DOM-Level-3-Core/core.html#ID-637646024">W3C DOM spec</a>.  The
reference documentation is at: <a class="reference external" href="https://metacpan.org/pod/XML::LibXML::Attr">XML::LibXML::Attr</a>.  Some additional methods are
inherited from the Node class but not all the Node methods work with Attr
objects (once again due to behaviour specified by the W3C DOM).</p>
<div class="highlight-perl"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span class="c1"># You probably don&#39;t need this object interface for attributes at all.</span>
<span class="c1"># The previous example showed how to access attributes directly via</span>
<span class="c1"># the Element object.</span>

<span class="k">my</span> <span class="nv">$book</span> <span class="o">=</span> <span class="nv">$dom</span><span class="o">-&gt;</span><span class="n">documentElement</span><span class="p">;</span>
<span class="k">my</span><span class="p">(</span><span class="nv">$dim</span><span class="p">)</span> <span class="o">=</span> <span class="nv">$book</span><span class="o">-&gt;</span><span class="n">getChildrenByTagName</span><span class="p">(</span><span class="s">&#39;dimensions&#39;</span><span class="p">);</span>
<span class="k">my</span><span class="p">(</span><span class="nv">$width_attr</span><span class="p">)</span> <span class="o">=</span> <span class="nv">$dim</span><span class="o">-&gt;</span><span class="n">getAttributeNode</span><span class="p">(</span><span class="s">&#39;width&#39;</span><span class="p">);</span>

<span class="n">say</span> <span class="s">&#39;$width_attr is a &#39;</span><span class="p">,</span> <span class="nb">ref</span><span class="p">(</span><span class="nv">$width_attr</span><span class="p">);</span>
<span class="n">say</span> <span class="s">&#39;$width_attr-&gt;nodeName: &#39;</span><span class="p">,</span> <span class="nv">$width_attr</span><span class="o">-&gt;</span><span class="n">nodeName</span><span class="p">;</span>
<span class="n">say</span> <span class="s">&#39;$width_attr-&gt;value: &#39;</span><span class="p">,</span> <span class="nv">$width_attr</span><span class="o">-&gt;</span><span class="n">value</span><span class="p">;</span>
<span class="n">say</span> <span class="s">&#39;$width_attr as a string: &#39;</span><span class="p">,</span> <span class="nv">$width_attr</span><span class="p">;</span>
</pre></div>
</td></tr></table></div>
<p>Output:</p>
<div class="highlight-none"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre>$width_attr is a XML::LibXML::Attr
$width_attr-&gt;nodeName: width
$width_attr-&gt;value: 162.56mm
$width_attr as a string:  width=&quot;162.56mm&quot;
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="nodelist-objects">
<h2>&#8216;NodeList&#8217; objects<a class="headerlink" href="#nodelist-objects" title="Permalink to this headline">¶</a></h2>
<p>The &#8216;NodeList&#8217; object is a part of the DOM that makes sense in DOM
implementations for other languages (e.g.: Java) but doesn&#8217;t make much sense in
Perl.  Methods such as <tt class="docutils literal"><span class="pre">childNodes()</span></tt> or <tt class="docutils literal"><span class="pre">findnodes()</span></tt> that may need to
return multiple nodes, return a &#8216;NodeList&#8217; object which contains the matching
nodes and allows the caller to iterate through the result set:</p>
<div class="highlight-perl"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">my</span> <span class="nv">$result</span> <span class="o">=</span> <span class="nv">$book</span><span class="o">-&gt;</span><span class="n">childNodes</span><span class="p">;</span>
<span class="n">say</span> <span class="s">&#39;$result is a &#39;</span><span class="p">,</span> <span class="nb">ref</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>
<span class="k">my</span> <span class="nv">$i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="k">foreach</span> <span class="k">my</span> <span class="nv">$i</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="nv">$result</span><span class="o">-&gt;</span><span class="n">size</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">my</span> <span class="nv">$node</span> <span class="o">=</span> <span class="nv">$result</span><span class="o">-&gt;</span><span class="n">get_node</span><span class="p">(</span><span class="nv">$i</span><span class="p">);</span>
    <span class="n">say</span> <span class="nv">$node</span><span class="o">-&gt;</span><span class="n">nodeName</span> <span class="k">if</span> <span class="nv">$node</span><span class="o">-&gt;</span><span class="n">nodeType</span> <span class="o">==</span> <span class="n">XML_ELEMENT_NODE</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Output:</p>
<div class="highlight-none"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre>$result is a XML::LibXML::NodeList
title
authors
isbn
dimensions
</pre></div>
</td></tr></table></div>
<p>But things don&#8217;t need to be that complicated in Perl - if a method needs to
return a list of values then it can just return a list of values.  So the Perl
bindings for DOM methods that would return a NodeList check the calling
context.  If called in a scalar context, they return a NodeList object (as
above) but in a list context they just return the list of values - much
simpler:</p>
<div class="highlight-perl"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">foreach</span> <span class="k">my</span> <span class="nv">$node</span> <span class="p">(</span><span class="nv">$book</span><span class="o">-&gt;</span><span class="n">childNodes</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">say</span> <span class="nv">$node</span><span class="o">-&gt;</span><span class="n">nodeName</span> <span class="k">if</span> <span class="nv">$node</span><span class="o">-&gt;</span><span class="n">nodeType</span> <span class="o">==</span> <span class="n">XML_ELEMENT_NODE</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>If for some reason you find yourself with a NodeList object you can extract
the contents as a simple list with <tt class="docutils literal"><span class="pre">$result-&gt;get_nodelist</span></tt>.</p>
<p>The NodeList object does implement the <tt class="docutils literal"><span class="pre">to_literal()</span></tt> method, which returns
the text content of all the nodes, concatenated together as a single string.
If you need a list of individual string values, you can use
<tt class="docutils literal"><span class="pre">$result-&gt;to_literal_list()</span></tt>:</p>
<div class="highlight-perl"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span class="n">say</span> <span class="s">&#39;Authors: &#39;</span><span class="p">,</span> <span class="nb">join</span> <span class="s">&#39;, &#39;</span><span class="p">,</span> <span class="nv">$book</span><span class="o">-&gt;</span><span class="n">findnodes</span><span class="p">(</span><span class="s">&#39;.//author&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">to_literal_list</span><span class="p">;</span>
</pre></div>
</td></tr></table></div>
<p>Output:</p>
<div class="highlight-none"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre>Authors: Gerry Bucsis, Barbara Somerville
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="modifying-the-dom">
<h2>Modifying the DOM<a class="headerlink" href="#modifying-the-dom" title="Permalink to this headline">¶</a></h2>
<p>... <em>&lt;to be continued&gt;</em> ...</p>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="installation.html" class="btn btn-neutral float-right" title="Installing XML::LibXML" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="xpath.html" class="btn btn-neutral" title="XPath Expressions" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Grant McLean.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="_static/plxbe.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>